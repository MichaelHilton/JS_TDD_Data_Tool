<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>COPE TDD Viewer</title>
	<link rel="stylesheet" href="css/style.css"/>
	<script src="src/jquery-2.1.0.js"></script>


	<script src="src/jquery.ui.position.js" type="text/javascript"></script>
	<script src="src/jquery.contextMenu.js" type="text/javascript"></script>

	<script src="src/jquery-ui.js"></script>
	<link href="src/jquery.contextMenu.css" rel="stylesheet" type="text/css" />
	<link href="css/ui-lightness/jquery-ui-1.10.4.css" rel="stylesheet">

	<script src="http://d3js.org/d3.v3.js"></script>
	<script src="http://d3js.org/d3.hive.v0.min.js"></script>
	<script type="text/javascript" src="PulsePlot.js"></script>

</head>
<body>

	<div id="PulseArea">
	 <div id="chart"></div>
	</div>

	<div id="settings">
		<h1>COPE TDD Viewer</h1>
		<label><input type="radio" name="diff_type" value="diffChars" checked> Chars</label>
		<label><input type="radio" name="diff_type" value="diffWords"> Words</label>
		<label><input type="radio" name="diff_type" value="diffLines"> Lines</label>
		<button style="margin-left: 20px;">Save Annotations</button>
		<img id="saveResult" >
	</div>

	<div id='tableContainer'>
	<table>
		<tr>
			<td contenteditable="true" id="a">restaurant</td>
			<td contenteditable="true" id="b">aura</td>
			<td><pre id="result"></pre></td>
		</tr>
	</table>
	</div>

	<div id="bottomBar" >
		<div id="allEvents" >
		</div>
	</div>
	<div id="Marker1"></div>



	<script src="diff.js"></script>
	<script defer>
		var lastUpdate = 'B';
		var a = document.getElementById('a');
		var b = document.getElementById('b');
		var result = document.getElementById('result');

		function changed() {
			var diff = JsDiff[window.diffType](a.textContent, b.textContent);
			var fragment = document.createDocumentFragment();
			for (var i=0; i < diff.length; i++) {

				if (diff[i].added && diff[i + 1] && diff[i + 1].removed) {
					var swap = diff[i];
					diff[i] = diff[i + 1];
					diff[i + 1] = swap;
				}

				var node;
				if (diff[i].removed) {
					node = document.createElement('del');
					node.appendChild(document.createTextNode(diff[i].value));
				} else if (diff[i].added) {
					node = document.createElement('ins');
					node.appendChild(document.createTextNode(diff[i].value));
				} else {
					node = document.createTextNode(diff[i].value);
				}
				fragment.appendChild(node);
			}

			result.textContent = '';
			result.appendChild(fragment);
		}

		window.onload = function() {
			onDiffTypeChange(document.querySelector('#settings [name="diff_type"]:checked'));
			changed();
		};

		a.onpaste = a.onchange =
		b.onpaste = b.onchange = changed;

		if ('oninput' in a) {
			a.oninput = b.oninput = changed;
		} else {
			a.onkeyup = b.onkeyup = changed;
		}

		function onDiffTypeChange(radio) {
			window.diffType = radio.value;
			document.title = "Diff " + radio.value.slice(4);
		}

		var radio = document.getElementsByName('diff_type');
		for (var i = 0; i < radio.length; i++) {
			radio[i].onchange = function(e) {
				onDiffTypeChange(e.target);
				changed();
			}
		}

		

		var w = 500,
			h = 500;

		var colorscale = d3.scale.category10();

		//Legend titles
		var LegendOptions = ['Smartphone','Tablet'];

		//RADAR CHART
		//Data
		var data = [
		  // {source: {x: 0, y0: 0.9, y1: 1.0}, target: {x: 1, y0: 0.5, y1: 1.0}, group:  0},
		  // {source: {x: 0, y0: 0.7, y1: 0.9}, target: {x: 1, y0: 0.4, y1: 0.5}, group:  1},
		  // {source: {x: 0, y0: 0.4, y1: 0.7}, target: {x: 1, y0: 0.2, y1: 0.4}, group:  2},
		  {source: {x: 0, y0: 0.0, y1: 0.4}, target: {x: 1, y0: 0.0, y1: 0.4}, group:  3},
		  // {source: {x: 1, y0: 0.8, y1: 1.0}, target: {x: 2, y0: 0.5, y1: 1.0}, group:  4},
		  // {source: {x: 1, y0: 0.5, y1: 0.8}, target: {x: 2, y0: 0.2, y1: 0.5}, group:  5},
		  // {source: {x: 1, y0: 0.3, y1: 0.5}, target: {x: 2, y0: 0.1, y1: 0.2}, group:  6},
		  {source: {x: 1, y0: 0.0, y1: 0.3}, target: {x: 2, y0: 0.0, y1: 0.3}, group:  7},
		  // {source: {x: 2, y0: 0.8, y1: 1.0}, target: {x: 0, y0: 0.5, y1: 1.0}, group:  8},
		  // {source: {x: 2, y0: 0.5, y1: 0.8}, target: {x: 0, y0: 0.2, y1: 0.5}, group:  9},
		  // {source: {x: 2, y0: 0.1, y1: 0.5}, target: {x: 0, y0: 0.1, y1: 0.2}, group: 10},
		  {source: {x: 2, y0: 0.0, y1: 0.1}, target: {x: 0, y0: 0.0, y1: 0.1}, group: 11}
		];


		//Options for the Radar chart, other than default
		var mycfg2 = {
		  w: 300,
		  h: 300,
		  maxValue: 0.6,
		  levels: 1,
		  ExtraWidthX: 300
		}

		// //Call function to draw the Radar chart
		// //Will expect that data is in %'s
				// PulsePlot.draw("#chart", d2, mycfg2);

		//initialize the chart with a width and height, xdata function and y data function.
		// var myChart = pulsePlot().width(400).height(200);

		var myChart = pulsePlot().width(800).height(400);
		
		d3.select("#chart")
		      .datum(data)
		      .call(myChart);

		// //Attach the datum, and then draw the chart.  In this example we are using data.tsv
		// d3.tsv("data.tsv", function(error, data) {
		//   d3.select("#areaChartDiv")
		//       .datum(data)
		//       .call(myChart);
		//   });
				


	</script>

	<script src="CopeViewer.js"></script>
</body>
</html>
